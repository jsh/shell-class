Hal Pomeranz's solution is here.

http://blog.commandlinekungfu.com/2010/11/episode-122-more-whacking-of-moles.html

I love Hal's "Command-Line Kung Fu" blog, which he shares with Tim Medin, Ed
Skoudis, and Paul Asadoorian. The blog takes reader-submitted problems
and offers duelling solutions in different operating systems and their
command interpreters.
